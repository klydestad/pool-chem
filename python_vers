import pandas as pd

def check_range(data_frame, column, min_val, max_val):
    """
    Checks if each entry in a specified column of a data frame is within a specified numerical range.

    Parameters:
        data_frame (pd.DataFrame): The input data frame.
        column (str): The name of the column to check.
        min_val (float): The minimum value of the range.
        max_val (float): The maximum value of the range.

    Returns:
        pd.DataFrame: A new data frame with the original column and an additional column 'within_range'
                      indicating if each entry in the specified column is within the specified range.
    """
    within_range = (data_frame[column] >= min_val) & (data_frame[column] <= max_val)
    data_frame['within_range'] = within_range
    return data_frame


# Example usage:
if __name__ == "__main__":
    # Sample tidy data frame
    pool_data = {
        'Cl2': [3.0, 2.5, 8.0, 0.0, 1.0],
        'Alk': [100, 130, 70, 110, 20],
        'pH': [6.9, 7.3, 7.0, 7.5, 7.6]
    }
    df = pd.DataFrame(pool_data)

    # Specify the numerical range
    min_val = 0.5
    max_val = 3.0


    # Check if entries in column 'A' are within the range [min_val, max_val]
    df_result = check_range(df, 'Cl2', min_val, max_val)


    # Show the original column values next to True/False values
    print(df_result[['Cl2', 'within_range']])

